function initDraggableOrderControl(t){var r=JSON.parse(t.data);if(r){BX.loadScript("/bitrix/js/main/core/core_dragdrop.js",function(){(function a(){if(!!BX.DragDrop)window["dnd_parameter_"+t.propertyID]=new DragNDropOrderParameterControl(r,t);else setTimeout(a,50)})()})}}function DragNDropOrderParameterControl(t,r){var a=BX.util.getRandomString(5);this.params=r||{};this.items=this.getSortedItems(t);this.rootElementId="dnd_params_container_"+this.params.propertyID+"_"+a;this.dragItemClassName="dnd-order-draggable-item-"+this.params.propertyID+"-"+a;BX.loadCSS(this.getPath()+"/style.css?"+a);this.buildNodes();this.initDragDrop()}DragNDropOrderParameterControl.prototype={getPath:function(){var t=this.params.propertyParams.JS_FILE.split("/");t.pop();return t.join("/")},getSortedItems:function(t){if(!t)return[];var r=this.params.oInput.value||this.params.propertyParams.DEFAULT||"",a=[],e;var s=r.split(",");for(e in s){if(s.hasOwnProperty(e)){s[e]=BX.util.trim(s[e]);if(t[s[e]]){a.push({value:s[e],message:t[s[e]]})}}}for(e in t){if(t.hasOwnProperty(e)&&!BX.util.in_array(e,s)){a.push({value:e,message:t[e]})}}return a},buildNodes:function(){var t=BX.create("DIV",{props:{className:"dnd-order-draggable-control-container",id:this.rootElementId}});for(var r in this.items){if(this.items.hasOwnProperty(r)){t.appendChild(BX.create("INPUT",{attrs:{"data-value":this.items[r].value},props:{type:"button",className:"dnd-order-draggable-control dnd-order-draggable-item "+this.dragItemClassName,value:this.items[r].message},style:{display:"block",marginBottom:"5px"}}))}}this.params.oCont.appendChild(t)},initDragDrop:function(){if(BX.isNodeInDom(this.params.oCont)){this.dragdrop=BX.DragDrop.create({dragItemClassName:this.dragItemClassName,dragItemControlClassName:"dnd-order-draggable-control",sortable:{rootElem:BX(this.rootElementId)},dragEnd:BX.delegate(function(t,r,a){this.saveData()},this)})}else{setTimeout(BX.delegate(this.initDragDrop,this),50)}},saveData:function(){var t=this.params.oCont.querySelectorAll("."+this.dragItemClassName),r=[];for(var a in t){if(t.hasOwnProperty(a)){r.push(t[a].getAttribute("data-value"))}}this.params.oInput.value=r.join(",")}};
//# sourceMappingURL=script.map.js